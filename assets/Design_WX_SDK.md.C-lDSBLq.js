import{_ as t,c as s,o as i,a4 as a}from"./chunks/framework.Br2U662V.js";const c=JSON.parse('{"title":"SDK 调用微信 API","description":"","frontmatter":{},"headers":[],"relativePath":"Design/WX_SDK.md","filePath":"Design/WX_SDK.md"}'),d={name:"Design/WX_SDK.md"},n=a(`<h1 id="sdk-调用微信-api" tabindex="-1">SDK 调用微信 API <a class="header-anchor" href="#sdk-调用微信-api" aria-label="Permalink to &quot;SDK 调用微信 API&quot;">​</a></h1><h2 id="初始化" tabindex="-1">初始化 <a class="header-anchor" href="#初始化" aria-label="Permalink to &quot;初始化&quot;">​</a></h2><p>调用<code>Unity SDK</code>前，需要在主入口进行SDK初始化，回调后再执行主逻辑。</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">WX.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">InitSDK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 你的主逻辑</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="支持范围" tabindex="-1">支持范围 <a class="header-anchor" href="#支持范围" aria-label="Permalink to &quot;支持范围&quot;">​</a></h2><p>本<code>Unity SDK</code>对<code>WXSDK</code>的支持大体与<a href="https://developers.weixin.qq.com/minigame/dev/api/" target="_blank" rel="noreferrer">官网 API 文档</a>相同。</p><p>具体支持的 API 可以查看<code>WX.cs</code>文件，其中有详细注释说明。</p><h3 id="更新机制" tabindex="-1">更新机制 <a class="header-anchor" href="#更新机制" aria-label="Permalink to &quot;更新机制&quot;">​</a></h3><p>新版<code>Unity SDK</code>会在<a href="https://github.com/wechat-miniprogram/minigame-api-typings/blob/master/types/wx/lib.wx.api.d.ts" target="_blank" rel="noreferrer">lib.wx.api.d.ts</a>更新后及时更新。 若基础库更新后<a href="https://github.com/wechat-miniprogram/minigame-api-typings/blob/master/types/wx/lib.wx.api.d.ts" target="_blank" rel="noreferrer">lib.wx.api.d.ts</a>暂未更新，开发者可参考<a href="./CustomSDK.html">自定义SDK调用</a>临时调用WXSDK。 以<code>wx.shareAppMessageToGroup</code>为例：</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WeChatWASM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ShareAppMessageToGroupOption</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> title</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> imageUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 合适位置调用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">WX.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CallJSFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;wx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;shareAppMessageToGroup&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ShareAppMessageToGroupOption</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;群任务&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="unity-sdk-特供api" tabindex="-1">Unity SDK 特供API <a class="header-anchor" href="#unity-sdk-特供api" aria-label="Permalink to &quot;Unity SDK 特供API&quot;">​</a></h3><p>此处列出<a href="https://github.com/wechat-miniprogram/minigame-api-typings/blob/master/types/wx/lib.wx.api.d.ts" target="_blank" rel="noreferrer">lib.wx.api.d.ts</a>中未列出，仅在<code>Unity SDK</code>中可用的API列表。</p><table><thead><tr><th>类别</th><th>函数名</th><th>备注</th></tr></thead><tbody><tr><td><strong>基础功能</strong></td><td>InitSDK</td><td>初始化SDK</td></tr><tr><td></td><td>CanIUse</td><td>判断API在当前环境是否可用</td></tr><tr><td></td><td>SetDevicePixelRatio</td><td>设置设备像素比</td></tr><tr><td></td><td>CallJSFunction</td><td>调用JS函数</td></tr><tr><td></td><td>CallJSFunctionWithReturn</td><td>调用JS函数并获取返回值</td></tr><tr><td><strong>字体</strong></td><td>GetWXFont</td><td>获取微信字体</td></tr><tr><td><strong>广告</strong></td><td>CreateFixedBottomMiddleBannerAd</td><td>创建固定底部中间的bannerAd</td></tr><tr><td><strong>社交组件</strong></td><td>CreateMiniGameChat</td><td>创建社交组件</td></tr><tr><td><strong>开放数据域</strong></td><td>ShowOpenData</td><td>显示开放数据域Canvas</td></tr><tr><td></td><td>HideOpenData</td><td>显示开放数据域Canvas</td></tr><tr><td><strong>音频</strong></td><td>PreDownloadAudios</td><td>预下载音频资源</td></tr><tr><td><strong>云测试</strong></td><td>IsCloudTest</td><td>是否小游戏云测试环境</td></tr><tr><td><strong>隐私协议弹窗</strong></td><td>PrivacyAuthorizeResolve</td><td>由于C#侧无法直接返回JS绑定函数，所以新增一个API专门用于在WX.OnNeedPrivacyAuthorization的回调内调用</td></tr><tr><td><strong>本地缓存</strong></td><td>StorageSetIntSync</td><td>同wx.setStorageSync</td></tr><tr><td></td><td>StorageGetIntSync</td><td>同wx.getStorageSync</td></tr><tr><td></td><td>StorageSetStringSync</td><td>同wx.setStorageSync</td></tr><tr><td></td><td>StorageSetFloatSync</td><td>同wx.setStorageSync</td></tr><tr><td></td><td>StorageGetFloatSync</td><td>同wx.getStorageSync</td></tr><tr><td></td><td>StorageDeleteAllSync</td><td>同wx.clearStorageSync</td></tr><tr><td></td><td>StorageDeleteKeySync</td><td>同wx.removeStorageSync</td></tr><tr><td></td><td>StorageHasKeySync</td><td>判断本地缓存中是否包含该key</td></tr><tr><td><strong>文件缓存清理</strong></td><td>CleanAllFileCache</td><td>清理所有文件缓存</td></tr><tr><td></td><td>CleanFileCache</td><td>清理文件缓存</td></tr><tr><td></td><td>RemoveFile</td><td>删除文件</td></tr><tr><td></td><td>GetCachePath</td><td>获取缓存路径</td></tr><tr><td><strong>性能</strong></td><td>GetTotalMemorySize</td><td>获取当前UnityHeap总内存(峰值)</td></tr><tr><td></td><td>GetTotalStackSize</td><td>获取当前UnityHeap Stack大小</td></tr><tr><td></td><td>GetStaticMemorySize</td><td>获取当前UnityHeap静态内存</td></tr><tr><td></td><td>GetDynamicMemorySize</td><td>获取当前UnityHeap动态内存</td></tr><tr><td></td><td>GetUsedMemorySize</td><td>获取已使用UnityHeap内存大小</td></tr><tr><td></td><td>GetUnAllocatedMemorySize</td><td>获取未分配UnityHeap内存大小</td></tr><tr><td></td><td>LogUnityHeapMem</td><td>打印UnityHeap内存</td></tr><tr><td></td><td>GetBundleNumberInMemory</td><td>获取当前AssetBundle在JS内存中的数量</td></tr><tr><td></td><td>GetBundleNumberOnDisk</td><td>获取当前AssetBundle在磁盘中不可清理的数量</td></tr><tr><td></td><td>GetBundleSizeInMemory</td><td>获取当前AssetBundle在JS内存中的体积</td></tr><tr><td></td><td>GetBundleSizeOnDisk</td><td>获取当前AssetBundle在磁盘中不可清理的体积</td></tr><tr><td></td><td>OpenProfileStats</td><td>打开性能面板</td></tr><tr><td></td><td>ProfilingMemoryDump</td><td>ProfilingMemory内存Dump</td></tr><tr><td><strong>LogManager</strong></td><td>WriteLog</td><td>同LogManager.log</td></tr><tr><td></td><td>WriteWarn</td><td>同LogManager.warn</td></tr><tr><td></td><td>LogManagerDebug</td><td>同LogManager.debug</td></tr><tr><td></td><td>LogManagerInfo</td><td>同LogManager.info</td></tr><tr><td></td><td>LogManagerLog</td><td>同LogManager.log</td></tr><tr><td></td><td>LogManagerWarn</td><td>同LogManager.warn</td></tr><tr><td><strong>上报</strong></td><td>ReportUserBehaviorBranchAnalytics</td><td>分支相关的UI组件相关事件的上报</td></tr><tr><td></td><td>UncaughtException</td><td>异常上报</td></tr><tr><td></td><td>ReportGameSceneError</td><td>上报游戏自定义场景的错误信息</td></tr><tr><td><strong>插件配置</strong></td><td>SetDataCDN</td><td>设置数据CDN</td></tr><tr><td></td><td>SetPreloadList</td><td>设置预加载列表</td></tr><tr><td><strong>启动剧情</strong></td><td>GetLaunchOperaHandler</td><td>获取启动剧情交互句柄</td></tr><tr><td><strong>其他</strong></td><td>ReportGameStart</td><td>游戏开始运行时上报</td></tr><tr><td></td><td>HideLoadingPage</td><td>隐藏加载页</td></tr><tr><td></td><td>PreloadConcurrent</td><td>控制预载并发数</td></tr><tr><td></td><td>OnLaunchProgress</td><td>获取启动loader的启动数据</td></tr></tbody></table><h3 id="暂未支持的wxapi" tabindex="-1">暂未支持的WXAPI <a class="header-anchor" href="#暂未支持的wxapi" aria-label="Permalink to &quot;暂未支持的WXAPI&quot;">​</a></h3><p><code>暂未支持的WXAPI</code>中有一部分接口<strong>需要在开放数据域调用</strong>，故暂无法支持。</p><table><thead><tr><th>主类别</th><th>副类别</th><th>函数名</th><th>描述</th></tr></thead><tbody><tr><td><strong>基础</strong></td><td><strong>分包加载</strong></td><td>wx.loadSubpackage</td><td>触发分包加载</td></tr><tr><td><strong>转发</strong></td><td></td><td>wx.checkHandoffEnabled</td><td>检查是否可以进行接力</td></tr><tr><td></td><td></td><td>wx.startHandoff</td><td>开始进行接力</td></tr><tr><td><strong>界面</strong></td><td><strong>窗口</strong></td><td>wx.setWindowSize</td><td>设置窗口大小</td></tr><tr><td><strong>网络</strong></td><td><strong>WebSocket</strong></td><td>wx.sendSocketMessage</td><td>通过 WebSocket 连接发送数据</td></tr><tr><td></td><td></td><td>wx.onSocketOpen</td><td>监听 WebSocket 连接打开事件</td></tr><tr><td></td><td></td><td>wx.onSocketMessage</td><td>监听 WebSocket 接收到服务器的消息事件</td></tr><tr><td></td><td></td><td>wx.onSocketError</td><td>监听 WebSocket 错误事件</td></tr><tr><td></td><td></td><td>wx.onSocketClose</td><td>监听 WebSocket 连接关闭事件</td></tr><tr><td></td><td></td><td>wx.closeSocket</td><td>关闭 WebSocket 连接</td></tr><tr><td><strong>数据缓存</strong></td><td></td><td>wx.getStorage</td><td>异步获取本地缓存</td></tr><tr><td></td><td></td><td>wx.setStorage</td><td>异步存储本地缓存</td></tr><tr><td></td><td></td><td>wx.setStorageSync</td><td>同步存储本地缓存</td></tr><tr><td></td><td></td><td>wx.getStorageSync</td><td>同步获取本地缓存</td></tr><tr><td></td><td></td><td>wx.clearStorage</td><td>异步清理本地缓存</td></tr><tr><td></td><td></td><td>wx.clearStorageSync</td><td>同步清理本地缓存</td></tr><tr><td></td><td></td><td>wx.createBufferURL</td><td>创建Buffer URL</td></tr><tr><td><strong>渲染</strong></td><td><strong>图片</strong></td><td>wx.createImage</td><td>创建图片对象</td></tr><tr><td><strong>开放接口</strong></td><td><strong>开放数据</strong></td><td>wx.getFriendCloudStorage</td><td>获取同玩好友托管数据</td></tr><tr><td></td><td></td><td>wx.getGroupCloudStorage</td><td>获取群同玩成员游戏数据</td></tr><tr><td></td><td></td><td>wx.getGroupInfo</td><td>获取群信息</td></tr><tr><td></td><td></td><td>wx.getPotentialFriendList</td><td>获取可能对游戏感兴趣的未注册的好友名单</td></tr><tr><td></td><td></td><td>wx.getUserCloudStorage</td><td>获取当前用户托管数据</td></tr><tr><td></td><td></td><td>wx.getUserCloudStorageKeys</td><td>获取当前用户托管数据键值</td></tr><tr><td></td><td></td><td>wx.modifyFriendInteractiveStorage</td><td>修改好友的互动型托管数据</td></tr><tr><td></td><td></td><td>wx.shareMessageToFriend</td><td>给指定的好友分享游戏信息</td></tr><tr><td><strong>工具</strong></td><td></td><td>wx.encode</td><td>将字符串编码成ArrayBuffer</td></tr><tr><td></td><td></td><td>wx.decode</td><td>将ArrayBuffer解码成字符串</td></tr></tbody></table><h2 id="调用方法" tabindex="-1">调用方法 <a class="header-anchor" href="#调用方法" aria-label="Permalink to &quot;调用方法&quot;">​</a></h2><p>Unity 版本的 API 大体与<a href="https://developers.weixin.qq.com/minigame/dev/api/" target="_blank" rel="noreferrer">官网 API 文档</a>的 JS 版本 API 类似，使用时可以参考。</p><p>如 JS 版的 banner 广告的调用如下：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bannerAd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createBannerAd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    adUnitId: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;xxxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    adIntervals: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    style: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        left: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        top: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        width: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        height: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bannerAd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onLoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bannerAd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bannerAd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>而对于 Unity 版的调用如下：</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bannerAd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WX.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CreateBannerAd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WXCreateBannerAdParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    adUnitId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;xxxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    adIntervals </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    style </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        left </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        top </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bannerAd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OnLoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bannerAd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bannerAd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OnError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WXADErrorResponse</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Debug.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res.errCode);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>大体是将 JS 版中的<code>wx</code>替换为 Unity 版的<code>WX</code>,然后对应方法名首字母由小写改为大写，如<code>createBannerAd</code>就变为<code>CreateBannerAd</code></p><h2 id="基础库" tabindex="-1">基础库 <a class="header-anchor" href="#基础库" aria-label="Permalink to &quot;基础库&quot;">​</a></h2><ul><li><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/client-lib/" target="_blank" rel="noreferrer">基础库介绍</a></li><li><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/client-lib/version.html" target="_blank" rel="noreferrer">基础库版本分布</a></li></ul><h3 id="在-unity-中兼容低版本基础库" tabindex="-1">在 Unity 中兼容低版本基础库 <a class="header-anchor" href="#在-unity-中兼容低版本基础库" aria-label="Permalink to &quot;在 Unity 中兼容低版本基础库&quot;">​</a></h3><p>使用<code>WX.CanIUse</code>可以判断当前版本是否支持该 API（仅支持 wx），例如想要判断当前环境<code>WX.ReportScene</code>是否可用，可以用<code>WX.CanIUse(&quot;ReportScene&quot;)</code>来判断</p><h2 id="开发建议" tabindex="-1">开发建议 <a class="header-anchor" href="#开发建议" aria-label="Permalink to &quot;开发建议&quot;">​</a></h2><h3 id="api-示例" tabindex="-1">API 示例 <a class="header-anchor" href="#api-示例" aria-label="Permalink to &quot;API 示例&quot;">​</a></h3><p>使用示例我们会逐渐补充到<a href="https://github.com/wechat-miniprogram/minigame-unity-webgl-transform/tree/main/Demo" target="_blank" rel="noreferrer">Demo</a>, 其中 API 项目为常见使用范例，请优先查阅用法。</p><h3 id="联调效率" tabindex="-1">联调效率 <a class="header-anchor" href="#联调效率" aria-label="Permalink to &quot;联调效率&quot;">​</a></h3><p>如果开发者有简单的 JS 代码经验，建议先以 JS 方式直接修改 minigame 的 JS 代码进行调试，完成之后再使用 C# SDK 修改 Unity 工程：</p><ol><li>只保留 game.js 前面 import 部分，其余删除，即不运行游戏逻辑。</li><li>增加以下代码：</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GameGlobal.canvas.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;webgl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gl.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gl.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COLOR_BUFFER_BIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><ol start="3"><li>使用 JS 编写需要调试的 API</li></ol><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h2><ol><li>广告接口是否需要上线后才能调试</li></ol><ul><li>是的，需要上线并累计 UV&gt;1000 才可以开通广告主</li></ul>`,38),e=[n];function r(h,l,p,k,o,g){return i(),s("div",null,e)}const y=t(d,[["render",r]]);export{c as __pageData,y as default};
