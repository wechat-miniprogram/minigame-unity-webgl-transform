import{_ as i,a as o,b as t}from"./chunks/profile3.CffCZqR8.js";import{_ as e,c as n,o as s,a4 as l}from"./chunks/framework.Br2U662V.js";const h=JSON.parse('{"title":"使用Unity Profiler性能调优","description":"","frontmatter":{},"headers":[],"relativePath":"Design/UnityProfiler.md","filePath":"Design/UnityProfiler.md"}'),r={name:"Design/UnityProfiler.md"},a=l('<h1 id="使用unity-profiler性能调优" tabindex="-1">使用Unity Profiler性能调优 <a class="header-anchor" href="#使用unity-profiler性能调优" aria-label="Permalink to &quot;使用Unity Profiler性能调优&quot;">​</a></h1><ol><li>导出选项时勾选&quot;Development Build&quot;与&quot;Autoconnect Profiler&quot;</li></ol><img src="'+i+'" width="800"><ol start="2"><li>打开Unity-Window-Analysis-Profile窗口</li></ol><img src="'+o+'" width="400"><p>Unity将自启动监听端口34999等待调试链接，对于WebGL版本会启动websockify.js(用于websocket转发)。 此时，导出的WebGL游戏在浏览器时能自动连接到Unity Profiler。</p><ol start="3"><li><p>微信开发者工具小游戏Profile 使用转换脚本导出微信小游戏包并启动小游戏，微信小游戏将自动连接到Unity Profiler <img src="'+t+`" width="400"></p></li><li><p>调整UnityProfiler IP/端口</p></li></ol><p>网页WebGL/小游戏启动后将通过&quot;ws://ip:port&quot;自动连接到“Unity Profiler”， 此地址默认为编译机器的。如果无法连接请查看微信开发者工具Network页签对应的ws链接是否正常可达。 如需手工调整IP、端口可通修改<code>webgl.wasm.framework.unityweb.js</code>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>     if(port == 54998) </span></span>
<span class="line"><span>     {</span></span>
<span class="line"><span>        url = &quot;ws://127.0.0.1:54998&quot;</span></span>
<span class="line"><span>     }</span></span>
<span class="line"><span>     ws = new WebSocketConstructor(url, opts);</span></span>
<span class="line"><span>     ws.binaryType = &quot;arraybuffer&quot;;</span></span></code></pre></div><p>重启UnityProfiler监听，可通过在命令行执行引擎自带Node启动websocketfy.js：</p><ul><li>windows: &quot;$UNITY_PATH/Editor/Data/Tools/nodejs/node.exe&quot; &quot;$UNITY_PATH/Editor/Data/PlaybackEngines/WebGLSupport/BuildTools/websockify/websockify.js&quot; 0.0.0.0:port localhost:34999</li><li>mac: /Applications/Unity/Hub/Editor/$Verson/PlaybackEngines/WebGLSupport/BuildTools/Emscripten/node/node /Applications/Unity/Hub/Editor/$Verson/PlaybackEngines/WebGLSupport/BuildTools/websockify/websockify.js 0.0.0.0:port localhost:34999 -vv</li></ul><p>(其中$UNITY_PATH为对应Unity版本的安装目录)</p><ol start="5"><li>注意事项</li></ol><ul><li>并非每个Unity版本UnityProfiler都稳定，如果发现无法正常的情况请尝试更换小版本</li><li>Unity2021建议使用InstantGame版本，支持增强的Profiler数据，下载地址请查阅 <a href="./UnityVersion.html">推荐引擎版本</a></li><li>当小游戏无法连接UnityProfile时，请检查UnityProfiler是否已启动监听，且IP/端口可达。通常使用&quot;BuildSetting&quot;-&quot;Build And Run&quot;打开浏览器时，UnityProfiler会默认启动监听; 否则请参考前文手动“重启UnityProfiler监听”。</li></ul><p>附录:</p><ul><li>Profiler窗口使用说明 <a href="https://docs.unity3d.com/cn/2019.4/Manual/ProfilerWindow.html" target="_blank" rel="noreferrer">https://docs.unity3d.com/cn/2019.4/Manual/ProfilerWindow.html</a></li></ul>`,16),p=[a];function c(u,d,f,y,P,_){return s(),n("div",null,p)}const U=e(r,[["render",c]]);export{h as __pageData,U as default};
