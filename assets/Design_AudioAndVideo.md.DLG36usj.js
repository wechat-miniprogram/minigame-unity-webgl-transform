import{_ as e,c as i,o as a,a4 as l}from"./chunks/framework.Br2U662V.js";const f=JSON.parse('{"title":"音视频适配","description":"","frontmatter":{},"headers":[],"relativePath":"Design/AudioAndVideo.md","filePath":"Design/AudioAndVideo.md"}'),t={name:"Design/AudioAndVideo.md"},r=l('<h1 id="音视频适配" tabindex="-1">音视频适配 <a class="header-anchor" href="#音视频适配" aria-label="Permalink to &quot;音视频适配&quot;">​</a></h1><h2 id="音频" tabindex="-1">音频 <a class="header-anchor" href="#音频" aria-label="Permalink to &quot;音频&quot;">​</a></h2><p>目前 UnityAudio 已自动适配微信小游戏，优先建议使用 UnityAudio 来播放音频，也支持 FMOD 插件</p><h2 id="兼容原理" tabindex="-1">兼容原理 <a class="header-anchor" href="#兼容原理" aria-label="Permalink to &quot;兼容原理&quot;">​</a></h2><p>UnityAudio 原理：</p><ul><li>长音频播放使用的是<a href="https://developers.weixin.qq.com/minigame/dev/api/media/audio/InnerAudioContext.html" target="_blank" rel="noreferrer">InnerAudio</a></li><li>短音频播放使用的是<a href="https://developers.weixin.qq.com/minigame/dev/api/media/audio/WebAudioContext.html" target="_blank" rel="noreferrer">WebAudio</a></li><li>Unity 插件会根据音频文件大小自动适配使用不同的播放方式</li></ul><p>FMOD 原理：</p><ul><li>全部使用<a href="https://developers.weixin.qq.com/minigame/dev/api/media/audio/WebAudioContext.html" target="_blank" rel="noreferrer">WebAudio</a>，因此不推荐背景音乐等大文件使用 FMOD 播放，会占用很大内存</li></ul><h3 id="qa" tabindex="-1">QA <a class="header-anchor" href="#qa" aria-label="Permalink to &quot;QA&quot;">​</a></h3><ol><li>在 IOS 17.5 以上的版本，小游戏退后台后返回音效无法继续播放了</li></ol><ul><li>可以尝试更新最新的插件版本，可以避免一些出现的情况，我们正在尝试兼容 IOS 的更新</li></ul><ol start="2"><li>IOS 偶现音频报错 operateAudio:fail jsapi has no permission</li></ol><ul><li>音频播放时小游戏退后台就有可能出现，没有实际影响，可以忽略</li></ul><ol start="3"><li>音频播放时游戏卡顿</li></ol><ul><li>如果同时播放的音频数量过多，是有可能造成游戏延迟卡顿的，建议限制同时播放的音频数量</li></ul><ol start="4"><li>部分音频文件在安卓无法循环播放</li></ol><ul><li>已知问题，8.0.51 客户端版本修复</li></ul><ol start="5"><li>音频在 PC 端无法循环播放完整音频</li></ol><ul><li>已知问题，更新最新的 Unity 导出插件</li></ul><ol start="6"><li>推荐使用什么音频格式</li></ol><ul><li>推荐 mp3 或者 aac 格式，在双端有较好的兼容</li></ul><ol start="7"><li>FMOD returns error code 36</li></ol><ul><li>旧版本引擎已知问题，推荐使用已修复的 Unity 引擎版本，参考<a href="https://developer.unity.cn/ask/question/65b3435fedbc2a001ee80796" target="_blank" rel="noreferrer">Unity 社区回答</a></li></ul><h2 id="视频" tabindex="-1">视频 <a class="header-anchor" href="#视频" aria-label="Permalink to &quot;视频&quot;">​</a></h2><p>在微信小游戏中有两种播放视频的方式，目前 VideoPlayer 组件已自动适配微信小游戏，只有全屏视频的场景也可以选择使用<a href="https://github.com/wechat-miniprogram/minigame-unity-webgl-transform/tree/main/Demo/WX_Video" target="_blank" rel="noreferrer">WXVideo API</a></p><h3 id="videoplayer-支持版本" tabindex="-1">VideoPlayer 支持版本 <a class="header-anchor" href="#videoplayer-支持版本" aria-label="Permalink to &quot;VideoPlayer 支持版本&quot;">​</a></h3><p>不同客户端的支持情况不同，以下为最低支持版本：</p><table><thead><tr><th>参数</th><th>版本</th></tr></thead><tbody><tr><td>IOS 高性能+</td><td>8.0.55</td></tr><tr><td>IOS 高性能</td><td>8.0.41</td></tr><tr><td>安卓</td><td>8.0.40</td></tr><tr><td>PC</td><td>基础库 3.2.1</td></tr><tr><td>开发者工具</td><td>基础库 3.2.1 + 1.06.2310312</td></tr></tbody></table><h3 id="qa-1" tabindex="-1">QA <a class="header-anchor" href="#qa-1" aria-label="Permalink to &quot;QA&quot;">​</a></h3><ol><li>VideoPlayer 视频在 IOS 无法播放，在其他平台都可以播放？</li></ol><ul><li>可以尝试把视频播放链接替换我们这个视频链接试试看是否正常，一般这种情况都是服务端设置问题，会报错<code>Origin weapp://wechat-game-runtime is not allowed by Access-Control-Allow-Origin</code>，但是没有打印到客户端，只需要配置服务端允许微信跨域访问即可（视频链接：<a href="https://wxsnsdy.tc.qq.com/105/20210/snsdyvideodownload?filekey=30280201010421301f0201690402534804102ca905ce620b1241b726bc41dcff44e00204012882540400&amp;bizid=1023&amp;hy=SH&amp;fileparam=302c020101042530230204136ffd93020457e3c4ff02024ef202031e8d7f02030f42400204045a320a0201000400" target="_blank" rel="noreferrer">https://wxsnsdy.tc.qq.com/105/20210/snsdyvideodownload?filekey=30280201010421301f0201690402534804102ca905ce620b1241b726bc41dcff44e00204012882540400&amp;bizid=1023&amp;hy=SH&amp;fileparam=302c020101042530230204136ffd93020457e3c4ff02024ef202031e8d7f02030f42400204045a320a0201000400</a> ）</li></ul><ol start="2"><li>VideoPlayer 视频在 IOS 播放有声音没画面？</li></ol><ul><li><p>情况一：开启了高性能+，需要升级最新版本的导出插件</p></li><li><p>情况二：设置了 videoPlayer.frame，IOS 不支持设置该属性</p></li></ul><ol start="3"><li>VideoPlayer 为什么在 IOS 高性能模式只能同时播放一个视频？</li></ol><ul><li>IOS 的播放策略，只能从逻辑上兼容</li></ul><ol start="4"><li>应该使用 VideoPlayer 还是 WXVideo？</li></ol><ul><li>如果只是单纯使用全屏的视频播放，更推荐使用小游戏 API 视频播放能力。请参考<a href="https://developers.weixin.qq.com/minigame/dev/api/media/video/wx.createVideo.html" target="_blank" rel="noreferrer">小游戏开发者文档</a>以及示例<a href="https://github.com/wechat-miniprogram/minigame-unity-webgl-transform/tree/main/Demo/WX_Video" target="_blank" rel="noreferrer">Video Demo</a></li></ul><ol start="5"><li>WXVideo 真机播放正常，开发者工具无法播放？</li></ol><ul><li>开发者工具暂时有异常，先主动切换到<code>3.4.10</code>版本基础库查看</li></ul><ol start="6"><li>WXVideo 在 IOS 设置 underGameView 之后黑屏，有声音没画面？</li></ol><ul><li>需要开启高性能模式</li></ul><ol start="7"><li>VideoPlayer 的路径可以填哪些？</li></ol><ul><li>支持填 cdn，微信本地文件路径，streamingAssets。最新版本的导出插件已支持本地文件路径，可以缓存视频文件到本地，减少重复下载。</li></ul>',43),o=[r];function d(n,s,u,h,c,m){return a(),i("div",null,o)}const b=e(t,[["render",d]]);export{f as __pageData,b as default};
